import{j as e,a as u,r as f,f as ue,B as xe,c as ge,d as he,q as fe,H as be}from"./index-_ibJpO5e.js";const je=({value:s,size:l=80,strokeWidth:h=6,color:o="var(--color-accent)"})=>{const a=(l-h)/2,i=a*2*Math.PI,c=i-s/100*i;return e.jsxs("div",{className:"circular-progress",style:{width:l,height:l},children:[e.jsxs("svg",{width:l,height:l,children:[e.jsx("circle",{className:"circular-progress-track",cx:l/2,cy:l/2,r:a,strokeWidth:h}),e.jsx("circle",{className:"circular-progress-fill",cx:l/2,cy:l/2,r:a,strokeWidth:h,stroke:o,strokeDasharray:i,strokeDashoffset:c})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xl font-bold text-foreground",children:[s,"%"]})})]})},pe=({skinType:s,confidence:l,characteristics:h})=>{var b;const o=t=>{switch(t){case"oily":return"Droplets";case"dry":return"Sun";case"sensitive":return"Heart";case"combination":return"Layers";default:return"Sparkles"}},a=t=>{switch(t){case"oily":return"from-blue-400/20 to-cyan-400/20";case"dry":return"from-orange-400/20 to-amber-400/20";case"sensitive":return"from-rose-400/20 to-pink-400/20";case"combination":return"from-purple-400/20 to-violet-400/20";default:return"from-accent/20 to-secondary/20"}},i=t=>{switch(t){case"oily":return"text-blue-500";case"dry":return"text-orange-500";case"sensitive":return"text-rose-500";case"combination":return"text-purple-500";default:return"text-accent"}},c=t=>{switch(t){case"oily":return"bg-blue-500/10";case"dry":return"bg-orange-500/10";case"sensitive":return"bg-rose-500/10";case"combination":return"bg-purple-500/10";default:return"bg-accent/10"}},y=t=>{switch(t){case"oily":return"Your skin produces excess sebum, particularly in the T-zone. We recommend oil-control products.";case"dry":return"Your skin needs extra moisture. Focus on hydrating and nourishing products.";case"sensitive":return"Your skin requires gentle care. Choose fragrance-free, hypoallergenic formulas.";case"combination":return"Your skin has both oily and dry areas. Use targeted products for each zone.";default:return"Your personalized skincare plan is ready based on your unique skin profile."}},g=(h==null?void 0:h.slice(0,4))||[];return e.jsxs("div",{className:"relative overflow-hidden rounded-2xl mb-8 animate-fade-in",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a(s)} opacity-60`}),e.jsx("div",{className:"absolute inset-0 glass"}),e.jsxs("div",{className:"relative p-6 md:p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-16 h-16 md:w-20 md:h-20 rounded-2xl ${c(s)} flex items-center justify-center animate-float`,children:e.jsx(u,{name:o(s),size:36,className:i(s)})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-foreground capitalize",children:[s," ",e.jsx("span",{className:"text-muted-foreground font-normal",children:"Skin"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Analyzed on ",(b=new Date)==null?void 0:b.toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(je,{value:l||87}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Confidence"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Match Score"})]})]})]}),e.jsx("p",{className:"text-foreground/80 mb-6 max-w-2xl",children:y(s)}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 stagger-children",children:g.map((t,w)=>e.jsx("div",{className:"bg-background/60 backdrop-blur-sm rounded-xl p-3 border border-border/50 card-hover",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${c(s).replace("/10","")} mt-2 flex-shrink-0`}),e.jsx("span",{className:"text-sm text-foreground leading-tight",children:t})]})},w))})]})]})},Ne=({product:s})=>{var w,x,R;const[l,h]=f.useState(!1),o=I=>{window.open(I,"_blank","noopener,noreferrer")},a=I=>{var F;return I?(F=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}))==null?void 0:F.format(I):null},i=(s==null?void 0:s.image)||(s==null?void 0:s.image_url),c=(s==null?void 0:s.purchaseUrl)||(s==null?void 0:s.purchase_url)||"#",y=(s==null?void 0:s.originalPrice)||(s==null?void 0:s.original_price),g=(s==null?void 0:s.rating)||4.5,b=(s==null?void 0:s.reviewCount)||0,t=y&&(s!=null&&s.price)?Math.round((y-s.price)/y*100):null;return e.jsxs("div",{className:`group relative bg-background rounded-2xl overflow-hidden border transition-all duration-300 ${l?"border-accent/40 shadow-xl shadow-accent/10":"border-border/50 hover:border-border"}`,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[e.jsxs("div",{className:"relative aspect-square overflow-hidden bg-muted/30",children:[e.jsx(ue,{src:i,alt:(s==null?void 0:s.imageAlt)||(s==null?void 0:s.name),className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-2",children:[((w=s==null?void 0:s.aiVoting)==null?void 0:w.voteCount)>0&&e.jsxs("span",{className:"px-2.5 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-medium rounded-full flex items-center gap-1",children:[e.jsx(u,{name:"Sparkles",size:12}),Math.round(s.aiVoting.avgScore*10),"% Match"]}),(s==null?void 0:s.badge)&&e.jsx("span",{className:"px-2.5 py-1 bg-foreground text-background text-xs font-medium rounded-full",children:s.badge}),t&&e.jsxs("span",{className:"px-2.5 py-1 bg-accent text-white text-xs font-medium rounded-full",children:["-",t,"%"]})]}),e.jsx("button",{className:"absolute top-3 right-3 w-9 h-9 bg-background/90 backdrop-blur-sm rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-sm hover:bg-background",children:e.jsx(u,{name:"Heart",size:16,className:"text-muted-foreground hover:text-accent transition-colors"})}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("button",{onClick:()=>o(c),className:"w-full py-2.5 bg-white text-foreground text-sm font-medium rounded-xl hover:bg-accent hover:text-white transition-colors flex items-center justify-center gap-2",children:[e.jsx(u,{name:"ShoppingBag",size:16}),"Quick Buy"]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide mb-1",children:s==null?void 0:s.brand}),e.jsx("h3",{className:"font-medium text-foreground mb-2 line-clamp-2 leading-snug",children:s==null?void 0:s.name}),((R=(x=s==null?void 0:s.aiVoting)==null?void 0:x.reasons)==null?void 0:R.length)>0&&e.jsxs("p",{className:"text-xs text-purple-600 mb-2 line-clamp-1 italic",children:["✨ ",s.aiVoting.reasons[0]]}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(u,{name:"Star",size:14,className:"text-amber-400 fill-amber-400"})}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:g}),b>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",b==null?void 0:b.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a(s==null?void 0:s.price)&&e.jsx("span",{className:"text-lg font-bold text-foreground",children:a(s==null?void 0:s.price)}),y&&e.jsx("span",{className:"text-sm text-muted-foreground line-through",children:a(y)})]})]})]})},ye=({onFilterChange:s,activeFilters:l})=>{const[h,o]=f.useState(!1),a=[{id:"type",label:"Product Type",options:[{value:"cleanser",label:"Cleanser"},{value:"moisturizer",label:"Moisturizer"},{value:"serum",label:"Serum"},{value:"sunscreen",label:"Sunscreen"},{value:"toner",label:"Toner"},{value:"mask",label:"Face Mask"}]},{id:"priceRange",label:"Price Range",options:[{value:"0-25",label:"Under $25"},{value:"25-50",label:"$25 - $50"},{value:"50-100",label:"$50 - $100"},{value:"100+",label:"Over $100"}]},{id:"concerns",label:"Skin Concerns",options:[{value:"acne",label:"Acne & Blemishes"},{value:"dryness",label:"Dryness"},{value:"sensitivity",label:"Sensitivity"},{value:"aging",label:"Anti-Aging"},{value:"pores",label:"Large Pores"},{value:"pigmentation",label:"Dark Spots"}]}],i=(g,b)=>{const t=(l==null?void 0:l[g])||[],w=t!=null&&t.includes(b)?t==null?void 0:t.filter(x=>x!==b):[...t,b];s(g,w)},c=()=>{a==null||a.forEach(g=>{s(g==null?void 0:g.id,[])})},y=()=>{var g;return(g=Object.values(l))==null?void 0:g.reduce((b,t)=>b+(t==null?void 0:t.length),0)};return e.jsxs("div",{className:"bg-card border border-border rounded-xl p-4 mb-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{name:"Filter",size:20,className:"text-accent"}),e.jsx("h3",{className:"font-semibold text-foreground",children:"Filter Products"}),y()>0&&e.jsx("div",{className:"bg-accent text-accent-foreground px-2 py-1 rounded-full text-xs font-medium",children:y()})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[y()>0&&e.jsx(xe,{variant:"ghost",size:"sm",onClick:c,iconName:"X",iconPosition:"left",className:"text-sm",children:"Clear All"}),e.jsxs(xe,{variant:"ghost",size:"sm",onClick:()=>o(!h),iconName:h?"ChevronUp":"ChevronDown",iconPosition:"right",className:"md:hidden",children:[h?"Hide":"Show"," Filters"]})]})]}),e.jsx("div",{className:`${h?"block":"hidden"} md:block`,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:a==null?void 0:a.map(g=>{var b;return e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground mb-3",children:g==null?void 0:g.label}),e.jsx("div",{className:"space-y-2",children:(b=g==null?void 0:g.options)==null?void 0:b.map(t=>{var x;const w=(x=(l==null?void 0:l[g==null?void 0:g.id])||[])==null?void 0:x.includes(t==null?void 0:t.value);return e.jsxs("button",{onClick:()=>i(g==null?void 0:g.id,t==null?void 0:t.value),className:`flex items-center space-x-2 w-full text-left p-2 rounded-lg transition-colors ${w?"bg-accent/10 text-accent border border-accent/20":"text-muted-foreground hover:text-foreground hover:bg-muted"}`,children:[e.jsx("div",{className:`w-4 h-4 rounded border-2 flex items-center justify-center ${w?"border-accent bg-accent":"border-muted-foreground/30"}`,children:w&&e.jsx(u,{name:"Check",size:12,className:"text-accent-foreground"})}),e.jsx("span",{className:"text-sm",children:t==null?void 0:t.label})]},t==null?void 0:t.value)})})]},g==null?void 0:g.id)})})})]})},ve=({score:s,icon:l,name:h,size:o=100})=>{const i=(o-6)/2,c=i*2*Math.PI,y=c-s/100*c,g=t=>t>=80?"#10B981":t>=60?"#F59E0B":"#EF4444",b=t=>t>=80?"bg-emerald-50 dark:bg-emerald-950/30":t>=60?"bg-amber-50 dark:bg-amber-950/30":"bg-red-50 dark:bg-red-950/30";return e.jsxs("div",{className:`flex flex-col items-center p-4 rounded-2xl ${b(s)} card-hover`,children:[e.jsxs("div",{className:"circular-progress relative",style:{width:o,height:o},children:[e.jsxs("svg",{width:o,height:o,children:[e.jsx("circle",{className:"circular-progress-track",cx:o/2,cy:o/2,r:i,strokeWidth:6,style:{stroke:"rgba(0,0,0,0.1)"}}),e.jsx("circle",{className:"circular-progress-fill",cx:o/2,cy:o/2,r:i,strokeWidth:6,stroke:g(s),strokeDasharray:c,strokeDashoffset:y})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(u,{name:l||"Circle",size:20,className:"text-muted-foreground mb-1"}),e.jsx("span",{className:"text-lg font-bold text-foreground",children:s})]})]}),e.jsx("span",{className:"mt-3 text-sm font-medium text-foreground text-center",children:h})]})},ke=({tip:s,index:l})=>e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-background/60 rounded-xl border border-border/50",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-accent/10 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-xs font-bold text-accent",children:l+1})}),e.jsx("p",{className:"text-sm text-foreground leading-relaxed",children:s})]}),we=({analysisData:s})=>{var h,o;const l=(s==null?void 0:s.metrics)||[];return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"glass-accent rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent/10 flex items-center justify-center",children:e.jsx(u,{name:"BarChart3",size:20,className:"text-accent"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Skin Metrics"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Detailed breakdown of your skin analysis"})]})]}),l.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{name:"PieChart",size:40,className:"mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No detailed metrics available. Complete an image analysis for deeper insights."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 stagger-children",children:l.slice().sort((a,i)=>((i==null?void 0:i.score)||0)-((a==null?void 0:a.score)||0)).map((a,i)=>e.jsx(ve,{score:(a==null?void 0:a.score)||0,icon:a==null?void 0:a.icon,name:a==null?void 0:a.name,size:90},i))})]}),((h=s==null?void 0:s.tips)==null?void 0:h.length)>0&&e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center",children:e.jsx(u,{name:"Lightbulb",size:20,className:"text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Personalized Tips"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Recommendations based on your skin profile"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 stagger-children",children:s.tips.slice(0,4).map((a,i)=>e.jsx(ke,{tip:a,index:i},i))})]}),((o=s==null?void 0:s.raw)==null?void 0:o.explanation)&&e.jsx("div",{className:"bg-accent/5 border border-accent/20 rounded-2xl p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(u,{name:"Info",size:18,className:"text-accent mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-foreground mb-1 text-sm",children:"AI Analysis Summary"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:s.raw.explanation})]})]})}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted/30 rounded-xl text-sm",children:[e.jsx(u,{name:"Shield",size:16,className:"text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:["Analysis based on your quiz responses",s!=null&&s.raw?" and uploaded image":"","."]})]})]})},Se=({skinType:s,routineSteps:l,isLoading:h,error:o})=>{const[a,i]=f.useState("morning"),[c,y]=f.useState(null),g=x=>{switch(x){case"cleanser":return"Droplets";case"toner":return"Spray";case"serum":return"FlaskConical";case"moisturizer":return"Heart";case"sunscreen":return"Shield";case"treatment":return"Zap";default:return"Circle"}},b=x=>{switch(x){case"cleanser":return"bg-blue-500";case"toner":return"bg-purple-500";case"serum":return"bg-amber-500";case"moisturizer":return"bg-rose-500";case"sunscreen":return"bg-orange-500";case"treatment":return"bg-emerald-500";default:return"bg-accent"}},t=(l==null?void 0:l[a])||[],w=x=>{y(c===x?null:x)};return e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"flex p-1 bg-muted/50 rounded-2xl mb-6 max-w-md",children:[e.jsxs("button",{onClick:()=>i("morning"),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl text-sm font-medium transition-all ${a==="morning"?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx(u,{name:"Sun",size:18}),"Morning"]}),e.jsxs("button",{onClick:()=>i("evening"),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl text-sm font-medium transition-all ${a==="evening"?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx(u,{name:"Moon",size:18}),"Evening"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gradient-to-b from-accent via-accent/50 to-transparent"}),h?e.jsxs("div",{className:"text-center py-12 ml-14",children:[e.jsx(u,{name:"Loader2",size:32,className:"mx-auto text-accent mb-3 animate-spin"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Generating your personalized ",a," routine..."]})]}):o?e.jsxs("div",{className:"text-center py-12 ml-14",children:[e.jsx(u,{name:"AlertCircle",size:32,className:"mx-auto text-amber-500 mb-3"}),e.jsx("p",{className:"text-sm text-foreground font-medium mb-1",children:"Unable to generate routine"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o})]}):t.length===0?e.jsxs("div",{className:"text-center py-12 ml-14",children:[e.jsx(u,{name:"Sparkles",size:32,className:"mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No routine available yet. Complete a skin analysis to get personalized recommendations."})]}):e.jsx("div",{className:"space-y-4 stagger-children",children:t==null?void 0:t.map((x,R)=>e.jsxs("div",{className:"relative pl-14",children:[e.jsx("div",{className:`absolute left-0 w-12 h-12 rounded-full ${b(x==null?void 0:x.type)} flex items-center justify-center shadow-lg`,children:e.jsx(u,{name:g(x==null?void 0:x.type),size:20,className:"text-white"})}),e.jsxs("div",{className:"glass rounded-2xl overflow-hidden cursor-pointer card-hover",onClick:()=>w(R),children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs font-medium text-accent bg-accent/10 px-2 py-1 rounded-full",children:["Step ",R+1]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:x==null?void 0:x.timing})]}),e.jsx(u,{name:c===R?"ChevronUp":"ChevronDown",size:18,className:"text-muted-foreground"})]}),e.jsx("h4",{className:"font-semibold text-foreground mt-2",children:x==null?void 0:x.name}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:x==null?void 0:x.description})]}),c===R&&(x==null?void 0:x.tips)&&e.jsx("div",{className:"px-4 pb-4 animate-fade-in",children:e.jsx("div",{className:"p-3 bg-accent/5 rounded-xl border border-accent/10",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(u,{name:"Lightbulb",size:14,className:"text-accent mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-foreground leading-relaxed",children:x.tips})]})})})]})]},R))})]}),e.jsx("div",{className:"mt-8 p-5 gradient-soft rounded-2xl border border-accent/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent/10 flex items-center justify-center flex-shrink-0",children:e.jsx(u,{name:"Star",size:18,className:"text-accent"})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-foreground mb-1",children:["Pro Tip for ",s," Skin"]}),e.jsxs("p",{className:"text-sm text-muted-foreground leading-relaxed",children:[s==="oily"&&"Use oil-free products and don't skip moisturizer - hydration helps regulate oil production!",s==="dry"&&"Layer products from thinnest to thickest and seal with an occlusive moisturizer.",s==="sensitive"&&"Patch test new products and choose fragrance-free, hypoallergenic formulas.",s==="combination"&&"Use different products for different zones - lighter on T-zone, richer on cheeks.",!["oily","dry","sensitive","combination"].includes(s)&&"Consistency is key! Stick to your routine for at least 4-6 weeks to see results."]})]})]})})]})},Ce=({product:s,products:l,currentIndex:h,onClose:o,onNavigate:a})=>{var E,M,B,ee;const{user:i}=ge(),[c,y]=f.useState(null),[g,b]=f.useState(!0),[t,w]=f.useState(0),[x,R]=f.useState(0),[I,F]=f.useState(""),[ae,re]=f.useState(null),[G,L]=f.useState(""),[Q,V]=f.useState(!1),U="https://backend-three-sigma-81.vercel.app/api",O=()=>{try{const n=localStorage.getItem("gm_auth");if(n)return JSON.parse(n).token}catch{}return null},T=()=>{const n={"Content-Type":"application/json"},m=O();return m&&(n.Authorization=`Bearer ${m}`),n};f.useEffect(()=>{s!=null&&s.id&&(Z(),X())},[s==null?void 0:s.id]);const X=async()=>{try{const n=i==null?void 0:i.id;let m=null;try{m=JSON.parse(localStorage.getItem("glowmatch-quiz-data")||"{}").attemptId}catch{}await fetch(`${U}/products/${s.id}/view`,{method:"POST",headers:T(),body:JSON.stringify({userId:n,quizAttemptId:m})})}catch(n){console.debug("View tracking failed:",n)}},Z=async()=>{b(!0);try{const n=await fetch(`${U}/products/${s.id}/reviews`,{headers:T()});if(n.ok){const m=await n.json();y(m.data),w(m.data.userRating||0)}}catch(n){console.error("Error fetching reviews:",n)}finally{b(!1)}},Y=async n=>{if(!i){alert("Please login to rate products");return}try{const m=await fetch(`${U}/products/${s.id}/rate`,{method:"POST",headers:T(),body:JSON.stringify({rating:n})});if(m.ok){const v=await m.json();w(n),y(N=>({...N,avgRating:v.data.avgRating,totalRatings:v.data.totalRatings,userRating:n}))}}catch(m){console.error("Error rating:",m)}},ie=async n=>{if(n.preventDefault(),!i){alert("Please login to comment");return}if(I.trim()){V(!0);try{const m=await fetch(`${U}/products/${s.id}/comments`,{method:"POST",headers:T(),body:JSON.stringify({content:I})});if(m.ok){const v=await m.json();y(N=>({...N,comments:[v.data,...N.comments],totalComments:N.totalComments+1})),F("")}}catch(m){console.error("Error adding comment:",m)}finally{V(!1)}}},se=async n=>{if(!i){alert("Please login to reply");return}if(G.trim()){V(!0);try{const m=await fetch(`${U}/products/${s.id}/comments`,{method:"POST",headers:T(),body:JSON.stringify({content:G,parentId:n})});if(m.ok){const v=await m.json();y(N=>({...N,comments:N.comments.map(A=>A.id===n?{...A,replies:[...A.replies||[],v.data]}:A),totalComments:N.totalComments+1})),re(null),L("")}}catch(m){console.error("Error replying:",m)}finally{V(!1)}}},le=async(n,m,v)=>{if(!i){alert("Please login to like comments");return}try{const N=await fetch(`${U}/products/${s.id}/comments/${n}/like`,{method:"POST",headers:T()});if(N.ok){const A=await N.json(),$=C=>({...C,isLiked:A.data.liked,likes_count:C.likes_count+(A.data.liked?1:-1)});y(m&&v?C=>({...C,comments:C.comments.map(k=>k.id===v?{...k,replies:k.replies.map(H=>H.id===n?$(H):H)}:k)}):C=>({...C,comments:C.comments.map(k=>k.id===n?$(k):k)}))}}catch(N){console.error("Error liking:",N)}},te=async(n,m,v)=>{var N;if(confirm("Are you sure you want to delete this comment?"))try{if((await fetch(`${U}/products/${s.id}/comments/${n}`,{method:"DELETE",headers:T()})).ok)if(m&&v)y($=>({...$,comments:$.comments.map(C=>C.id===v?{...C,replies:C.replies.filter(k=>k.id!==n)}:C),totalComments:$.totalComments-1}));else{const $=c.comments.find(k=>k.id===n),C=((N=$==null?void 0:$.replies)==null?void 0:N.length)||0;y(k=>({...k,comments:k.comments.filter(H=>H.id!==n),totalComments:k.totalComments-1-C}))}}catch(A){console.error("Error deleting:",A)}},oe=()=>{const n=(s==null?void 0:s.purchaseUrl)||(s==null?void 0:s.purchase_url)||"#";window.open(n,"_blank","noopener,noreferrer")},ce=h>0,K=h<l.length-1,z=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),J=(n,m=!1,v=20)=>e.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(N=>e.jsx("button",{type:"button",disabled:!m,onClick:()=>m&&Y(N),onMouseEnter:()=>m&&R(N),onMouseLeave:()=>m&&R(0),className:`${m?"cursor-pointer hover:scale-110":"cursor-default"} transition-transform`,children:e.jsx(u,{name:"Star",size:v,className:`${N<=(m?x||t:n)?"text-amber-400 fill-amber-400":"text-gray-300"} transition-colors`})},N))}),d=(n,m=!1,v=null)=>{var N;return e.jsx("div",{className:`${m?"ml-8 mt-3":""}`,children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center flex-shrink-0",children:e.jsx(u,{name:"User",size:16,className:"text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-foreground",children:n.user_name||"User"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:z(n.created_at)})]}),e.jsx("p",{className:"text-sm text-foreground mb-2",children:n.content}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>le(n.id,m,v),className:`flex items-center gap-1 text-xs ${n.isLiked?"text-accent":"text-muted-foreground"} hover:text-accent transition-colors`,children:[e.jsx(u,{name:"Heart",size:14,className:n.isLiked?"fill-accent":""}),n.likes_count||0]}),!m&&e.jsx("button",{onClick:()=>re(ae===n.id?null:n.id),className:"text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Reply"}),n.isOwner&&e.jsx("button",{onClick:()=>te(n.id,m,v),className:"text-xs text-muted-foreground hover:text-destructive transition-colors",children:"Delete"})]}),ae===n.id&&e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("input",{type:"text",value:G,onChange:A=>L(A.target.value),placeholder:"Write a reply...",className:"flex-1 px-3 py-2 text-sm border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent/50"}),e.jsx("button",{onClick:()=>se(n.id),disabled:Q||!G.trim(),className:"px-3 py-2 bg-accent text-white text-sm rounded-lg hover:bg-accent/90 disabled:opacity-50",children:"Reply"})]}),(N=n.replies)==null?void 0:N.map(A=>d(A,!0,n.id))]})]})},n.id)};if(!s)return null;const S=(s==null?void 0:s.image)||(s==null?void 0:s.image_url),P=(s==null?void 0:s.brand)||"Unknown Brand",j=s==null?void 0:s.price,r=(s==null?void 0:s.originalPrice)||(s==null?void 0:s.original_price);return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:[ce&&e.jsx("button",{onClick:()=>a(h-1),className:"absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-background/90 rounded-full flex items-center justify-center shadow-lg hover:bg-background transition-colors z-10",children:e.jsx(u,{name:"ChevronLeft",size:24,className:"text-foreground"})}),K&&e.jsx("button",{onClick:()=>a(h+1),className:"absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-background/90 rounded-full flex items-center justify-center shadow-lg hover:bg-background transition-colors z-10",children:e.jsx(u,{name:"ChevronRight",size:24,className:"text-foreground"})}),e.jsxs("div",{className:"w-full max-w-2xl max-h-[90vh] bg-background rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground line-clamp-1",children:s==null?void 0:s.name}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-muted rounded-full transition-colors",children:e.jsx(u,{name:"X",size:20,className:"text-muted-foreground"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"w-40 h-40 rounded-xl overflow-hidden bg-muted flex-shrink-0",children:e.jsx(ue,{src:S,alt:s==null?void 0:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground uppercase tracking-wide mb-1",children:P}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[J(parseFloat((c==null?void 0:c.avgRating)||0)),e.jsx("span",{className:"text-sm font-medium text-foreground",children:(c==null?void 0:c.avgRating)||"0.0"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",(c==null?void 0:c.totalRatings)||0," reviews)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[j&&e.jsxs("span",{className:"text-2xl font-bold text-foreground",children:["$",j]}),r&&e.jsxs("span",{className:"text-lg text-muted-foreground line-through",children:["$",r]})]}),((E=s==null?void 0:s.aiVoting)==null?void 0:E.voteCount)>0&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-sm font-medium rounded-full mb-4",children:[e.jsx(u,{name:"Sparkles",size:14}),Math.round(s.aiVoting.avgScore*10),"% AI Match"]}),e.jsxs("button",{onClick:oe,className:"flex items-center justify-center gap-2 w-full py-3 bg-accent text-white font-medium rounded-xl hover:bg-accent/90 transition-colors",children:[e.jsx(u,{name:"ShoppingBag",size:18}),"Buy Now"]})]})]}),(s==null?void 0:s.description)&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-medium text-foreground mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),((B=(M=s==null?void 0:s.aiVoting)==null?void 0:M.reasons)==null?void 0:B.length)>0&&e.jsx("div",{className:"mt-4 p-3 bg-purple-50 rounded-xl",children:e.jsxs("p",{className:"text-sm text-purple-700",children:[e.jsx("span",{className:"font-medium",children:"✨ Why we recommend:"})," ",s.aiVoting.reasons[0]]})})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-border bg-muted/30",children:[e.jsx("h3",{className:"font-medium text-foreground mb-3",children:"Rate this product"}),e.jsxs("div",{className:"flex items-center gap-4",children:[J(t,!0,28),t>0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Your rating: ",t,"/5"]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-border",children:[e.jsxs("h3",{className:"font-medium text-foreground mb-4",children:["Comments (",(c==null?void 0:c.totalComments)||0,")"]}),e.jsxs("form",{onSubmit:ie,className:"flex gap-2 mb-6",children:[e.jsx("input",{type:"text",value:I,onChange:n=>F(n.target.value),placeholder:i?"Write a comment...":"Login to comment",disabled:!i,className:"flex-1 px-4 py-2 border border-border rounded-xl bg-background focus:outline-none focus:ring-2 focus:ring-accent/50 disabled:opacity-50"}),e.jsx("button",{type:"submit",disabled:Q||!I.trim()||!i,className:"px-4 py-2 bg-accent text-white rounded-xl hover:bg-accent/90 disabled:opacity-50 transition-colors",children:"Post"})]}),g?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(u,{name:"Loader2",size:24,className:"animate-spin text-accent"})}):((ee=c==null?void 0:c.comments)==null?void 0:ee.length)>0?e.jsx("div",{className:"space-y-4",children:c.comments.map(n=>d(n))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(u,{name:"MessageCircle",size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No comments yet. Be the first to comment!"})]})]})]})]})]})},ne=s=>{const l={morning:[{type:"cleanser",name:"Gentle Cleanser",description:"Start your day with a gentle cleanser to remove overnight oil and impurities.",timing:"1-2 minutes",tips:"Use lukewarm water and massage in circular motions."},{type:"toner",name:"Hydrating Toner",description:"Balance your skin's pH and prepare it for the next steps.",timing:"30 seconds",tips:"Pat gently into skin rather than rubbing."},{type:"serum",name:"Vitamin C Serum",description:"Antioxidant protection and brightening for the day ahead.",timing:"1 minute",tips:"Apply to slightly damp skin for better absorption."},{type:"moisturizer",name:"Lightweight Moisturizer",description:"Lock in hydration without feeling heavy.",timing:"1 minute",tips:"Let it absorb before applying sunscreen."},{type:"sunscreen",name:"SPF 30+ Sunscreen",description:"Protect your skin from UV damage - the most important step!",timing:"1-2 minutes",tips:"Apply generously and reapply every 2 hours when outdoors."}],evening:[{type:"cleanser",name:"Double Cleanse - Oil Cleanser",description:"Remove makeup and sunscreen with an oil-based cleanser.",timing:"1-2 minutes",tips:"Massage thoroughly to break down all impurities."},{type:"cleanser",name:"Double Cleanse - Water Cleanser",description:"Follow up with a water-based cleanser for a deep clean.",timing:"1-2 minutes",tips:"This ensures all residue is removed."},{type:"toner",name:"Hydrating Toner",description:"Rebalance and hydrate your skin after cleansing.",timing:"30 seconds",tips:"Use the same toner as your morning routine."},{type:"serum",name:"Treatment Serum",description:"Target your specific skin concerns with an active serum.",timing:"1 minute",tips:"Night is the best time for active ingredients like retinol."},{type:"moisturizer",name:"Night Cream",description:"Rich moisturizer to nourish and repair while you sleep.",timing:"1-2 minutes",tips:"Use a slightly heavier formula than your day cream."}]},h={oily:{morning:{moisturizer:"Oil-Free Gel Moisturizer",serum:"Niacinamide Serum"},evening:{moisturizer:"Lightweight Gel Cream",serum:"Salicylic Acid Serum"}},dry:{morning:{moisturizer:"Rich Hydrating Cream",serum:"Hyaluronic Acid Serum"},evening:{moisturizer:"Intensive Night Balm",serum:"Ceramide Serum"}},sensitive:{morning:{moisturizer:"Calming Moisturizer",serum:"Centella Asiatica Serum"},evening:{moisturizer:"Soothing Night Cream",serum:"Aloe Vera Serum"}},combination:{morning:{moisturizer:"Balancing Lotion",serum:"Niacinamide Serum"},evening:{moisturizer:"Light Night Cream",serum:"AHA/BHA Serum"}}},o=h[s==null?void 0:s.toLowerCase()]||h.combination;if(o.morning){const a=l.morning.find(c=>c.type==="moisturizer"),i=l.morning.find(c=>c.type==="serum");a&&(a.name=o.morning.moisturizer),i&&(i.name=o.morning.serum)}if(o.evening){const a=l.evening.find(c=>c.type==="moisturizer"),i=l.evening.find(c=>c.type==="serum");a&&(a.name=o.evening.moisturizer),i&&(i.name=o.evening.serum)}return l},Ae=()=>{const s=he(),[l,h]=f.useState({type:[],priceRange:[],concerns:[]}),[o,a]=f.useState([]),[i,c]=f.useState("analysis"),[y,g]=f.useState(null),[b,t]=f.useState(null),[w,x]=f.useState(!1),[R,I]=f.useState(null),[F,ae]=f.useState("gemini"),[re,G]=f.useState(null),[L,Q]=f.useState(!1),[V,U]=f.useState(null),[O,T]=f.useState([]),[X,Z]=f.useState(null),[Y,ie]=f.useState(null),se=f.useRef(!1),le={skinType:"combination",confidence:87,characteristics:["Oily T-zone with enlarged pores","Dry cheek areas requiring hydration","Occasional breakouts around nose","Good overall skin texture"]},te=async d=>{Q(!0),U(null);try{const S="https://backend-three-sigma-81.vercel.app/api",P=()=>{try{const M=localStorage.getItem("gm_auth");return M?{Authorization:`Bearer ${JSON.parse(M).token}`}:{}}catch{return{}}},j=await fetch(`${S}/products/ai-recommend`,{method:"POST",headers:{"Content-Type":"application/json",...P()},body:JSON.stringify({analysis:d})});if(!j.ok)throw new Error("Failed to fetch AI recommendations");const r=await j.json(),E=(r==null?void 0:r.data)||[];r!=null&&r.votingInfo&&console.log("[AI Voting]",r.votingInfo),T(E),a(E)}catch(S){console.error("Error fetching AI recommendations:",S),U("Unable to load AI product recommendations"),T([]),a([])}finally{Q(!1)}};f.useEffect(()=>{var P,j;const d=localStorage.getItem("glowmatch-analysis"),S=localStorage.getItem("glowmatch-quiz-data");if(!d||!S){s("/interactive-skin-quiz");return}try{const r=JSON.parse(d),E=JSON.parse(S),M=(E==null?void 0:E.attemptId)||null;ie(M),g(r);const B=(r==null?void 0:r.savedAnalysis)||null;if(B&&B.metrics){console.log("[Results] Using saved analysis data"),t(B),((P=B.products)==null?void 0:P.length)>0?(T(B.products),a(B.products)):te(r);return}const ee=(r==null?void 0:r.detailed)||((j=r==null?void 0:r.raw)==null?void 0:j.detailed)||null;ee&&t(ee),te(r),(async(n=F)=>{var m,v,N,A,$,C;try{x(!0),I(null);const k="https://backend-three-sigma-81.vercel.app/api",H=()=>{try{const D=localStorage.getItem("gm_auth");return D?{Authorization:`Bearer ${JSON.parse(D).token}`}:{}}catch{return{}}},_=await fetch(`${k}/analysis/expand`,{method:"POST",headers:{"Content-Type":"application/json",...H()},body:JSON.stringify({analysis:r,provider:n})});if(!_.ok){const D=await _.text().catch(()=>"Unknown error");console.warn("Expand API failed:",_.status,D),console.log("[Expand] Using fallback routine for skin type:",r==null?void 0:r.skinType);const W=ne(r==null?void 0:r.skinType);t(de=>({...de||{},routine:W,metrics:[],tips:[],rationale:"Personalized routine based on your skin type",generatedAt:new Date().toISOString(),isFallback:!0})),x(!1);return}const q=await _.json();console.log("[Expand] Response:",q),G(((m=q==null?void 0:q.data)==null?void 0:m.provider)||null);const p=((v=q==null?void 0:q.data)==null?void 0:v.generated)||null,me=(p==null?void 0:p.routine)&&Array.isArray(p.routine.morning)&&p.routine.morning.length>0||Array.isArray(p.routine.evening)&&p.routine.evening.length>0;if(p&&(((N=p.metrics)==null?void 0:N.length)>0||((A=p.tips)==null?void 0:A.length)>0||me)){const D=me?p.routine:ne(r==null?void 0:r.skinType),W={metrics:(($=p.metrics)==null?void 0:$.length)>0?p.metrics:[],tips:((C=p.tips)==null?void 0:C.length)>0?p.tips:[],routine:D,rationale:p.rationale||null,generatedAt:new Date().toISOString(),isFallback:!me};t(de=>({...de||{},...W}))}else{console.warn("[Expand] No meaningful data in response, using fallback:",p);const D=ne(r==null?void 0:r.skinType);t(W=>({...W||{},routine:D,metrics:(p==null?void 0:p.metrics)||[],tips:(p==null?void 0:p.tips)||[],rationale:"Personalized routine based on your skin type",generatedAt:new Date().toISOString(),isFallback:!0}))}}catch(k){console.warn("Expand fetch failed:",k);const H=localStorage.getItem("glowmatch-analysis");let _="combination";try{const p=JSON.parse(H);_=(p==null?void 0:p.skinType)||"combination"}catch{}console.log("[Expand] Using fallback routine after error for skin type:",_);const q=ne(_);t(p=>({...p||{},routine:q,metrics:[],tips:[],rationale:"Personalized routine based on your skin type",generatedAt:new Date().toISOString(),isFallback:!0}))}finally{x(!1)}})()}catch(r){console.error("Error parsing analysis data:",r),s("/interactive-skin-quiz")}},[s]),f.useEffect(()=>{var S;if(O.length===0)return;let d=[...O];(S=Object.entries(l))==null||S.forEach(([P,j])=>{(j==null?void 0:j.length)>0&&(d=d==null?void 0:d.filter(r=>{if(P==="type")return(j==null?void 0:j.includes(r==null?void 0:r.type))||(j==null?void 0:j.includes(r==null?void 0:r.category));if(P==="priceRange")return j==null?void 0:j.includes(r==null?void 0:r.priceRange);if(P==="concerns"){const E=Array.isArray(r==null?void 0:r.concerns)?r.concerns:[];return j==null?void 0:j.some(M=>E==null?void 0:E.includes(M))}return!0}))}),a(d)},[l,O]),f.useEffect(()=>{var S;const d=O.length>0&&!L;if(b&&(((S=b.metrics)==null?void 0:S.length)>0||b.routine),Y&&d&&!se.current){se.current=!0;const P={...b||{},products:O,savedAt:new Date().toISOString()};console.log("[Results] Saving complete analysis + products to database for attempt:",Y),fe.saveQuizAnalysis(Y,P).then(j=>{j.success?console.log("[Results] Complete analysis saved successfully"):console.warn("[Results] Failed to save:",j.error)}).catch(j=>console.warn("[Results] Error saving:",j))}},[O,Y,L,b]);const oe=(d,S)=>{h(P=>({...P,[d]:S}))},ce=()=>{localStorage.removeItem("glowmatch-analysis"),localStorage.removeItem("glowmatch-quiz-data"),localStorage.removeItem("glowmatch-quiz-progress"),s("/interactive-skin-quiz")},K=[{id:"analysis",label:"Analysis",icon:"BarChart3"},{id:"routine",label:"Routine",icon:"Clock"},{id:"products",label:"Products",icon:"ShoppingBag"}],z=y||le,J=b||null;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(be,{}),e.jsx("div",{className:"gradient-hero",children:e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center mb-8 animate-fade-in",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-accent/10 rounded-full text-sm text-accent font-medium mb-4",children:[e.jsx(u,{name:"Sparkles",size:16}),"Analysis Complete"]}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground mb-3",children:"Your Skin Profile"}),e.jsx("p",{className:"text-muted-foreground max-w-lg mx-auto",children:"Personalized insights and recommendations based on your unique skin analysis."})]}),e.jsx(pe,{skinType:z==null?void 0:z.skinType,confidence:z==null?void 0:z.confidence,characteristics:(z==null?void 0:z.characteristics)||(z==null?void 0:z.concerns)||[]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("div",{className:"inline-flex p-1.5 bg-muted/50 rounded-2xl",children:K==null?void 0:K.map(d=>e.jsxs("button",{onClick:()=>c(d==null?void 0:d.id),className:`flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium transition-all ${i===(d==null?void 0:d.id)?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx(u,{name:d==null?void 0:d.icon,size:16}),d==null?void 0:d.label]},d==null?void 0:d.id))})}),i==="analysis"&&e.jsxs("div",{className:"animate-fade-in",children:[w&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground mb-4",children:[e.jsx(u,{name:"Loader2",size:16,className:"animate-spin"}),"Generating detailed analysis..."]}),e.jsx(we,{analysisData:J})]}),i==="routine"&&e.jsx("div",{className:"animate-fade-in",children:e.jsx(Se,{skinType:z==null?void 0:z.skinType,routineSteps:(J==null?void 0:J.routine)||null,isLoading:w,error:R})}),i==="products"&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(ye,{onFilterChange:oe,activeFilters:l}),e.jsxs("div",{className:"flex items-center justify-between mb-4 mt-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Recommended for You"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:L?"Loading...":`${o==null?void 0:o.length} products`})]}),L&&e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 text-sm text-muted-foreground py-12",children:[e.jsx(u,{name:"Loader2",size:24,className:"animate-spin text-accent"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-foreground",children:"AI is analyzing products for you..."}),e.jsx("p",{className:"text-xs mt-1",children:"Multiple AI models are voting on the best matches"})]})]}),V&&!L&&e.jsxs("div",{className:"text-center py-8 px-4 bg-yellow-50 border border-yellow-200 rounded-2xl mb-4",children:[e.jsx(u,{name:"AlertCircle",size:24,className:"text-yellow-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-yellow-700",children:V}),e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Showing fallback recommendations"})]}),!L&&(o==null?void 0:o.length)>0?e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4",children:o==null?void 0:o.map((d,S)=>e.jsx("div",{onClick:()=>Z({product:d,index:S}),className:"cursor-pointer",children:e.jsx(Ne,{product:d})},d==null?void 0:d.id))}):!L&&(O==null?void 0:O.length)===0?e.jsxs("div",{className:"text-center py-12 bg-muted/30 rounded-2xl",children:[e.jsx(u,{name:"Package",size:40,className:"text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-foreground font-medium mb-2",children:"No products available yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Products will appear here once they are added by sellers"})]}):L?null:e.jsxs("div",{className:"text-center py-12 bg-muted/30 rounded-2xl",children:[e.jsx(u,{name:"Search",size:40,className:"text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No products match your filters"}),e.jsx("button",{onClick:()=>h({type:[],priceRange:[],concerns:[]}),className:"text-sm text-accent hover:underline",children:"Clear filters"})]})]}),e.jsx("div",{className:"mt-12 text-center",children:e.jsxs("div",{className:"inline-flex flex-col items-center p-6 glass-accent rounded-2xl",children:[e.jsx(u,{name:"RefreshCw",size:24,className:"text-accent mb-3"}),e.jsx("p",{className:"text-sm text-foreground mb-3",children:"Skin changes over time. Retake the quiz for updated recommendations."}),e.jsx("button",{onClick:ce,className:"px-5 py-2.5 bg-accent text-white text-sm font-medium rounded-xl hover:bg-accent/90 transition-colors",children:"Retake Quiz"})]})})]})}),X&&e.jsx(Ce,{product:X.product,products:o,currentIndex:X.index,onClose:()=>Z(null),onNavigate:d=>Z({product:o[d],index:d})})]})};export{Ae as default};
